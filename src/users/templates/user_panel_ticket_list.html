{% extends 'base.html' %}
    {% load static %}
    {% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تیکت - آیو فیلم</title>
    <link rel="stylesheet" href="{% static 'css/user_panel.css' %}">
    <link rel="stylesheet" href="{% static 'css/product_details.css' %}">
    {% endblock head %}
{% block body %}
<div id="container-content" class="mx-3">
    {% if messages %}
        <div id="message-modal" class="top-0 bottom-0 d-flex justify-content-center start-0 end-0 position-fixed bg-dark" style="z-index: 1050;">
            <div class="d-flex flex-column mt-5 w-50 mb-auto bg-gray text-white position-relative">
                <div class="w-100 text-start">
                    <button class="position-absolute m-0 p-0 text-light btn" style="right: -14px;;top: -20px;" aria-hidden="true" onclick="messageModal()"><i class="fa fa-times fs-2"></i></button>
                </div>
                {% for msg in messages %}
                <div class="my-4 text-center px-3">{{ msg }}</div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
    <div class="ms-3 mb-2 d-md-none">
        <i class="fa fa-address-card text-light fs-1 w-100 h-100 m-1" id="navBottom-dropdown" onclick="userModal()" style="cursor: pointer;" aria-hidden="true"></i>
    </div>
    <div class="d-flex flex-row justify-content-between">
        {% include 'user_panel_userbar.html' %}
        <div class="col-12 col-md-8 m-0 mx-md-3">
            <div class="d-flex flex-column">
                <div class="d-flex flex-row text-white my-3">
                    <h4>تیکت ها</h4>
                    <div class="ms-auto"><a href="{% url 'ticket-create' %}" class="btn btn-warning rounded rounded-3">ساخت تیکت حدید</a></div>
                </div>
                <div class="bg-gray">
                    {% if tickets %}
                    {% for ticket in tickets %}
                    <a href="{% url 'ticket-details' ticket.id %}" class="text-decoration-none d-flex flex-column text-white px-2 py-3 border-2 border-start border-end border-purple ticket-box">
                        <ul class="list-unstyled d-inline">
                            <li class="float-start">موضوع :‌ {{ ticket.subject }}</li>
                            <li class="float-start ms-3">دیپارتمنت : {{ ticket.department }}</li>
                            {% if ticket.admin_closed %}
                            <li class="float-start ms-3 px-2 bg-primary rounded rounded-pill">بسته شده توسط ادمین</li>
                            {% elif ticket.user_closed %}
                            <li class="float-start ms-3 px-2 bg-danger rounded rounded-pill">بسته شده توسط کاربر</li>
                            {% else %}
                            <li class="float-start ms-3 px-2 bg-success rounded rounded-pill">باز</li>
                            {% endif %}
                        </ul>
                        <div>آخرین بروز رسانی : <span>{{ ticket.updated_at|date:'Y/m/d H:i' }}<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock ms-1" viewBox="0 0 16 16">
                            <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"/>
                            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"/>
                          </svg></i>
                        </span></div>
                    </a>
                    {% endfor %}
                    {% else %}
                    <div class="text-center fs-3 text-white h-100">تیکتی وجود ندارد</div>
                    {% endif %}
                </div>
            </div>
            {% if max_tickets_counts > 20 %}
                <form method="get" class="text-white px-3 py-3 bg-gray d-flex flex-column gap-3 mb-5 flex-md-row w-100 justify-content-between mt-4 border border-1 border-purple">
                    <div class="mt-2">
                        نمایش از
                        <span>{{ tickets_counts }}</span>
                        تا
                        <span>{{ max_tickets_counts }}</span>
                        نتیجه
                    </div>
                    <div>
                        {% with object=tickets %}
                        {% include "paginator.html" %}
                        {% endwith %}
                    </div>
                </form>
            {% endif %}
        </div>
    </div>
</div>
<div id="user-modal" class="d-none d-md-none top-0 bottom-0 d-flex justify-content-start start-0 end-0 position-fixed bg-dark" style="z-index: 1050;">
    {% include 'user_panel_mobile_userbar.html' %}
</div>
{% endblock body %}
{% block script %}
<script src="{% static 'js/user_panel.js' %}" type="text/javascript"></script>
{% endblock script %}
    